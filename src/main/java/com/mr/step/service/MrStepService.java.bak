package com.mr.step.service;

import java.util.Date;
import java.util.List;

import org.springframework.stereotype.Service;

import com.common.file.domain.MrAtchFile;
import com.mr.mrrq.domain.MRrqRegisterVO;
import com.mr.step.domain.ChrgrChgHist;
import com.mr.step.domain.MrReqProcStepDetVO;
import com.mr.step.domain.MrReqProcStepVO;

/**
 * Step 서비스
 *
 * @author 박성룡
 * @version 1.0
 *
 *          <pre>
 * 수정일 | 수정자 | 수정내용
 * ---------------------------------------------------------------------
 * 2014.06.20 박성룡 최초 작성
 * </pre>
 */
@Service
public interface MrStepService{

    /**
     * 현재화면에 대한 결재라인 모드 반환
     * @param mrReqNo
     * @param mrStepCd
     * @return
     */
    String getModeClass(int mrReqNo);

    /**
     * 현재결재라인과 별도로 진행되는 프로세스에서 결재모드 반환
     * @param mrReqNo
     * @param mrStepCd
     * @param ingMrStepCd
     * @return
     */
    String isolationModeClass(int mrReqNo, String mrStepCd, List<String> ingMrStepCd, String chrgrClCd, boolean isMulti);

    /**
     * 특정화면에서 특정단계 권한 활성화.
     * @param mrReqNo
     * @param chrgrClCd
     * @return
     */
    String getSubModeClass(int mrReqNo, String chrgrClCd, String mrStepCd, boolean isLike);

    /**
     * 요청서 전체 단계 조회(왼쪽메뉴상태 나타낼대 사용)
     * @param mrReqNo
     * @return
     */
    List<MrReqProcStepVO> selectAllMrReqStep(int mrReqNo);

    /**
     * 신규 Step과 결재라인 생성(여러명)
     * procStCd를 null로 처리할경우 업데이트 로직을 수행합니다.
     * @param mrReqNo
     * @param mrStepCd
     * @param procStCd
     * @param appLine
     */
    int insertMrStep(int mrReqNo, String mrStepCd, String procStCd, List<ChrgrChgHist> appLine);

   
    /**
     * 직무검토자 생성
     * MR_STEP_CD가 변경되지 않기때문에 STEP번호를 넘겨줘야 합니다.
     * @param mrReqNo
     * @param mrReqProcStepNo
     * @param mrStepCd
     * @param procStCd
     * @param techEmps
     */
    void insertTechEmp(int mrReqNo, int mrReqProcStepNo, String mrStepCd, String procStCd, List<ChrgrChgHist> techEmps);

    /**
     * 신규 Step과 결재라인 생성(한명)한명진행(사용금지. insertMrStepSingleAction으로 변경하여 이용하세요.!!!)
     * @param mrReqNo
     * @param mrStepCd
     * @param procStCd
     * @param chrgrChgHist
     */
    @Deprecated
    void insertMrStep(int mrReqNo, String mrStepCd, String procStCd, String chrgrClCd);

    /**
     * 신규 Step과 결재라인 생성(한명)한명진행
     * 1. 보통 다음 단계 담당자 활성화시 사용한다. 상세 STEP만 변경시 사용하지 않도록 주의
     * @param mrReqNo
     * @param mrStepCd
     * @param procStCd
     * @param chrgrChgHist
     */
    void insertMrStepSingleAction(int mrReqNo, String mrStepCd, String procStCd, String chrgrClCd);

    /**
     * 신규 Step과 결재라인 생성(한명)동시진행
     * 1. 다음 단계가 동시해 진행이 필요하다면 사용할 것.
     * @param mrReqNo
     * @param mrStepCd
     * @param procStCd
     * @param appLine
     * @param lastAppChrgrClCd
     */
    void insertMrStepMultiAction(int mrReqNo, String mrStepCd, String procStCd, List<ChrgrChgHist> appLine, String lastAppChrgrClCd);

    /**
     * 특정 Step과, 특정상세상태로 결재라인 변경(한명)
     * 화면에서 다음단계 진행자 정보를 입력받지 않고 이전단계 혹은 DB에 있는 것을 조회해서 활성화 시킬경우 사용하세요.
     * 다음 담당자를 입력받지 않고 이전에 DB에 저장된 데이터를 기준으로 조회하여 활성화 할때 사용함.
     * @param mrReqNo
     * @param currentMrStepCd
     * @param nextProcStCd
     * @param nextChrgrClCd
     * @param getMrStepCd
     * @param getChrgrClCd
     */
    void updateMrStep(int mrReqNo, String currentMrStepCd, String nextProcStCd, String nextChrgrClCd, String getMrStepCd, String getChrgrClCd);
    
    int updateMrStep2(int mrReqNo, String currentMrStepCd, String nextProcStCd, String nextChrgrClCd, String getMrStepCd, String getChrgrClCd);

    /**
     * 결재라인 수정 (결재진행중)
     * @param mrReqNo
     * @param appLine
     * @param chrgrClCds
     */
    void updateAppLine(int mrReqNo, List<ChrgrChgHist> appLine, List<String> chrgrClCds);

    /**
     * Step과 다음 결재 진행
     * @param mrReqNo
     * @param procStCd
     */
    void insertNextAppEmp(int mrReqNo, String nextProcStCd);

    /**
     * 반려, 기각에서 결재라인 back
     * @param mrReqNo
     * @param procStCd
     */
    int insertPrevAppEmp(int mrReqNo, String mrStepCd, String prevProcStCd, List<ChrgrChgHist> appLine, String chrgrClCd);

    /**
     * 기본 결재라인과 별도로 진행되는 프로세스에서 다음 결재 진행
     * @param mrReqNo
     * @param procStCd
     */
    void insertIsolationNextAppEmp(int mrReqNo, String mrStepCd, String nextProcStCd);

    /**
     * 반려, 기각에서 결재라인 back
     * @param mrReqNo
     * @param procStCd
     */
    int insertIsolationPrevAppEmp(int mrReqNo, String mrStepCd, String prevProcStCd, List<ChrgrChgHist> appLine, String chrgrClCd);

    /**
     * STEP 종료 마킹
     * @param mrReqNo
     */
    void updateMrStepEffEnd(int mrReqNo);

    /**
     * 결재라인 유효날짜 마킹
     * @param mrReqNo
     */
    void updateMrAppLineEffEnd(int mrReqNo);

    /**
     * Step과 결재라인 수정
     * @param mrReqNo
     * @param mrStepCd
     * @param procStCd
     * @param appLine
     */
    @Deprecated
    void updateMrAppLine(int mrReqNo, String mrStepCd, String procStCd, List<ChrgrChgHist> appLine);

    /**
     * 직무검토 담당자 논리삭제
     * @param chrgrChgHist
     * @return
     */
    int updateTechEmpDelYn(ChrgrChgHist chrgrChgHist);

    /**
     * PORC 위원 입력처리
     * @param mrReqNo
     * @param mrStepCd
     * @param procStCd
     * @param appLine
     * @param isAction
     */
    void insertPorcAppLine(int mrReqNo, String mrStepCd, String procStCd, List<ChrgrChgHist> appLine, boolean isAction);

    /**
     * porc 담당자 전체 논리삭제
     * @param chrgrChgHist
     */
    void updatePorcAppLineDel(ChrgrChgHist chrgrChgHist);

    /**
     * 직무검토 전용 Next Step 진행
     * @param mrReqNo
     */
    void insertNextStepForJobs(int mrReqNo);

    /**
     * 직무검토 보류를 위한 JOB_RV_CD 업데이트
     * @param mrReqNo
     * @param jobRvCd
     * @return
     */
    int updateMrReqProcStepDetJobRvCd(int mrReqProcStepDetNo, String jobRvCd);

    /**
     * 기본 결재 기한일 반환 (현재일 + app config 기본셋팅값)
     * @return
     */
    Date getAppTerm();

    /**
     * 결재라인 단계상세, 담당자 논리삭제
     * @param mrReqNo
     * @param mrStepCd
     */
    void updateAppLineDel(int mrReqNo, String mrStepCd);

    /**
     * 결재기한 무한으로 할때 사용
     * @param endDate
     * @return
     */
    Date get99991231(String endDate);

    /**
     * 파일저장
     * @param mrReqNo
     * @param mrStepCd
     * @param chrgrClCd
     * @param fileStepCd
     * @param mrAtchFiles
     * @return 저장된 파일 갯수
     */
    int insertFile(int mrReqNo, String mrStepCd, String chrgrClCd, String fileStepCd, List<MrAtchFile> mrAtchFiles);

    /**
     * 요청서 기술검토담당자 정보를 조회한다.
     * @param mrReqNo
     * @param mrStepCds
     * @param chrgrClCds
     * @return
     */
	List<ChrgrChgHist> getMrReqTechEmpInfo(int mrReqNo, List<String> mrStepCds,List<String> chrgrClCds);

	/**
	 * 기존 요청서 기술검토담당자 이력을 삭제처리한다.
	 * @param mrReqTechEmpInfo
	 */
	void updateReqTechEmpDelYn(ChrgrChgHist mrReqTechEmpInfo);

	/**
	 * 변경된 기술검토담당자 정보를 등록한다.
	 * @param mrReqTechEmpInfo
	 */
	void insertChrgrChgHist(ChrgrChgHist mrReqTechEmpInfo);

	/**
	 * 요청서 단계의 Step정보를 조회한다.
	 * @param mrReqNo
	 * @param string
	 * @return
	 */
	MrReqProcStepVO selectOneMrReqStep(int mrReqNo, String string);

	/**
	 * mrReqProcStepDet의 정보를 삭제처리한다.
	 * @param delActEmpInfo
	 */
	void updatePorcStepDetNoDelYn(ChrgrChgHist delActEmpInfo);

	/**
	 * mrReqProcStepDet 정보를 등록한다.
	 * @param actMrReqProcStepDet
	 */
	void insertMrReqProcStepDet(MrReqProcStepDetVO actMrReqProcStepDet);

	/**
	 * 요청서 단계의 수행팀 정보를 삭제처리한다.
	 * @param delActEmpInfo
	 */
	void updateAppLineEffEnd(ChrgrChgHist delActEmpInfo);

    /**
     * Step과 다음 결재 진행 Multi
     * @param mrReqNo
     * @param procStCd
     */
	void insertNextAppEmpMulti(int mrReqNo, String nextProcStCd);

    
    /**
     * 
     * @param MRrqRegisterVO
     * @return
     */
    void updateMrIfStat01(MrReqProcStepDetVO mrReqProcStepDetVO);

    /**
     * 초기 투자비 추가담당자 삭제처리 업데이트
     * @param mrReqNo
     * @param procStCd
     * @param stepCd
     * @param chrgrClCd
     */
	void updateDetHistDel(int mrReqNo, String procStCd, String stepCd,
			String chrgrClCd);
	
	void readProcess(int mrReqNo, String currentMrStepCd, String nextProcStCd, String nextChrgrClCd, String getMrStepCd, String getChrgrClCd, int mrReqProcStepDetNo);
}
